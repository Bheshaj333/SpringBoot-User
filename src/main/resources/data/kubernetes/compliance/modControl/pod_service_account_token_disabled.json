{"severity":null,"file_name":"/home/bheshaj/steampipe-mod-kubernetes-compliance/controls/pod.sp","documentation":null,"query":"kubernetes_compliance.query.pod_service_account_token_disabled","description":"Automatic mapping of service account token should be disabled. By default, Kubernetes automatically provisions a service account when creating a Pod and mounts the account\u2019s secret token within the Pod at runtime. Many containerized applications do not require direct access to the service account as Kubernetes orchestration occurs transparently in the background. If an application is compromised, account tokens in Pods can be gleaned by cyber actors and used to further compromise the cluster. When an application does not need to access the service account directly, Kubernetes administrators should ensure that Pod specifications disable the secret token being mounted. This can be accomplished using the `automountServiceAccountToken: false` directive in the Pod\u2019s YAML specification.","end_line_number":92,"params":null,"start_line_number":84,"title":"Automatic mapping of the service account tokens should be disabled in Pod","type":null,"mod_name":"kubernetes_compliance","sql":null,"tags":{"plugin":"kubernetes","service":"Kubernetes/Pod","nsa_cisa_v1":"true","category":"Compliance"},"args":{"args_list":null,"refs":null},"auto_generated":false,"path":[["mod.kubernetes_compliance","kubernetes_compliance.benchmark.nsa_cisa_v1","kubernetes_compliance.benchmark.nsa_cisa_v1_pod_security","kubernetes_compliance.benchmark.nsa_cisa_v1_pod_security_service_account_token_disabled","kubernetes_compliance.control.pod_service_account_token_disabled"]],"qualified_name":"kubernetes_compliance.control.pod_service_account_token_disabled","source_definition":"control \"pod_service_account_token_disabled\" {\n  title       = \"Automatic mapping of the service account tokens should be disabled in Pod\"\n  description = local.service_account_token_disabled_desc\n  query       = query.pod_service_account_token_disabled\n\n  tags = merge(local.pod_common_tags, {\n    nsa_cisa_v1 = \"true\"\n  })\n}","is_anonymous":false,"width":null,"resource_name":"pod_service_account_token_disabled"}
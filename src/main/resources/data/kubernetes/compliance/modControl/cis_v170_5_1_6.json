{"severity":null,"file_name":"/home/bheshaj/steampipe-mod-kubernetes-compliance/cis_v170/section_5.sp","documentation":"## Description\n\nService accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server.\n\nMounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster.\n\nAvoiding mounting these tokens removes this attack avenue.\n\n## Remediation\n\nModify the definition of pods and service accounts which do not need to mount service account tokens to disable it.\n\n**Default Value:** By default, all pods get a service account token mounted in them.","query":"kubernetes_compliance.query.pod_service_account_token_disabled","description":"Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server.","end_line_number":75,"params":null,"start_line_number":63,"title":"5.1.6 Ensure that Service Account Tokens are only mounted where necessary","type":null,"mod_name":"kubernetes_compliance","sql":null,"tags":{"plugin":"kubernetes","cis_item_id":"5.1.6","cis_version":"v1.7.0","service":"Kubernetes/Pod","cis_section_id":"5.1","kubernetes_version":"v1.25","category":"Compliance","cis":"true","cis_type":"manual","cis_level":"1"},"args":{"args_list":null,"refs":null},"auto_generated":false,"path":[["mod.kubernetes_compliance","kubernetes_compliance.benchmark.cis_v170","kubernetes_compliance.benchmark.cis_v170_5","kubernetes_compliance.benchmark.cis_v170_5_1","kubernetes_compliance.control.cis_v170_5_1_6"]],"qualified_name":"kubernetes_compliance.control.cis_v170_5_1_6","source_definition":"control \"cis_v170_5_1_6\" {\n  title         = \"5.1.6 Ensure that Service Account Tokens are only mounted where necessary\"\n  description   = \"Service accounts tokens should not be mounted in pods except where the workload running in the pod explicitly needs to communicate with the API server.\"\n  query         = query.pod_service_account_token_disabled\n  documentation = file(\"./cis_v170/docs/cis_v170_5_1_6.md\")\n\n  tags = merge(local.cis_v170_5_1_common_tags, {\n    cis_level   = \"1\"\n    cis_item_id = \"5.1.6\"\n    cis_type    = \"manual\"\n    service     = \"Kubernetes/Pod\"\n  })\n}","is_anonymous":false,"width":null,"resource_name":"cis_v170_5_1_6"}
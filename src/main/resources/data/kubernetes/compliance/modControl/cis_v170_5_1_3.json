{"severity":null,"file_name":"/home/bheshaj/steampipe-mod-kubernetes-compliance/cis_v170/section_5.sp","documentation":"## Description\n\nKubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects. It is possible to set either of these to be the wildcard \"*\" which matches all items.\n\nUse of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.\n\nThe principle of least privilege recommends that users are provided only the access required for their role and nothing more. The use of wildcard rights grants is likely to provide excessive rights to the Kubernetes API.\n\n## Remediation\n\nWhere possible replace any use of wildcards in clusterroles and roles with specific objects or actions.","query":"kubernetes_compliance.query.role_with_wildcards_used","description":"Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects. It is possible to set either of these to be the wildcard \"*\" which matches all items. Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.","end_line_number":61,"params":null,"start_line_number":49,"title":"5.1.3 Minimize wildcard use in Roles and ClusterRoles","type":null,"mod_name":"kubernetes_compliance","sql":null,"tags":{"plugin":"kubernetes","cis_item_id":"5.1.3","cis_version":"v1.7.0","service":"Kubernetes/Role","cis_section_id":"5.1","kubernetes_version":"v1.25","category":"Compliance","cis":"true","cis_type":"manual","cis_level":"1"},"args":{"args_list":null,"refs":null},"auto_generated":false,"path":[["mod.kubernetes_compliance","kubernetes_compliance.benchmark.cis_v170","kubernetes_compliance.benchmark.cis_v170_5","kubernetes_compliance.benchmark.cis_v170_5_1","kubernetes_compliance.control.cis_v170_5_1_3"]],"qualified_name":"kubernetes_compliance.control.cis_v170_5_1_3","source_definition":"control \"cis_v170_5_1_3\" {\n  title         = \"5.1.3 Minimize wildcard use in Roles and ClusterRoles\"\n  description   = \"Kubernetes Roles and ClusterRoles provide access to resources based on sets of objects and actions that can be taken on those objects. It is possible to set either of these to be the wildcard \\\"*\\\" which matches all items. Use of wildcards is not optimal from a security perspective as it may allow for inadvertent access to be granted when new resources are added to the Kubernetes API either as CRDs or in later versions of the product.\"\n  query         = query.role_with_wildcards_used\n  documentation = file(\"./cis_v170/docs/cis_v170_5_1_3.md\")\n\n  tags = merge(local.cis_v170_5_1_common_tags, {\n    cis_level   = \"1\"\n    cis_item_id = \"5.1.3\"\n    cis_type    = \"manual\"\n    service     = \"Kubernetes/Role\"\n  })\n}","is_anonymous":false,"width":null,"resource_name":"cis_v170_5_1_3"}
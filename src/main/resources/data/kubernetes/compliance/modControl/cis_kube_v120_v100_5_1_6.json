{"severity":null,"file_name":"/home/bheshaj/steampipe-mod-kubernetes-compliance/cis_kube_v120/cis_kube_v120_v100.sp","documentation":"## Description\n\nService accounts tokens should not be mounted in pods except where the workload\nrunning in the pod explicitly needs to communicate with the API server.\n\nMounting service account tokens inside pods can provide an avenue for privilege escalation\nattacks where an attacker is able to compromise a single pod in the cluster.\n\nAvoiding mounting these tokens removes this attack avenue.\n\n## Remediation\n\nModify the definition of pods and service accounts which do not need to mount service account tokens to disable it.\n\n**References**\n\n1. https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\n","query":"kubernetes_compliance.query.pod_service_account_token_disabled","description":"Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster. Avoiding mounting these tokens removes this attack avenue.","end_line_number":81,"params":null,"start_line_number":69,"title":"5.1.6 Ensure that Service Account Tokens are only mounted where necessary","type":null,"mod_name":"kubernetes_compliance","sql":null,"tags":{"plugin":"kubernetes","cis_item_id":"5.1.6","cis_version":"v1.0.0","service":"Kubernetes/Pod","cis_section_id":"5.1","kubernetes_version":"v1.20","category":"Compliance","cis":"true","cis_type":"manual","cis_level":"1"},"args":{"args_list":null,"refs":null},"auto_generated":false,"path":[["mod.kubernetes_compliance","kubernetes_compliance.benchmark.cis_kube_v120","kubernetes_compliance.benchmark.cis_kube_v120_v100","kubernetes_compliance.benchmark.cis_kube_v120_v100_5","kubernetes_compliance.benchmark.cis_kube_v120_v100_5_1","kubernetes_compliance.control.cis_kube_v120_v100_5_1_6"]],"qualified_name":"kubernetes_compliance.control.cis_kube_v120_v100_5_1_6","source_definition":"control \"cis_kube_v120_v100_5_1_6\" {\n  title         = \"5.1.6 Ensure that Service Account Tokens are only mounted where necessary\"\n  description   = \"Mounting service account tokens inside pods can provide an avenue for privilege escalation attacks where an attacker is able to compromise a single pod in the cluster. Avoiding mounting these tokens removes this attack avenue.\"\n  query         = query.pod_service_account_token_disabled\n  documentation = file(\"./cis_kube_v120/docs/cis_kube_v120_v100_5_1_6.md\")\n\n  tags = merge(local.cis_kube_v120_v100_5_1_common_tags, {\n    cis_level   = \"1\"\n    cis_item_id = \"5.1.6\"\n    cis_type    = \"manual\"\n    service     = \"Kubernetes/Pod\"\n  })\n}","is_anonymous":false,"width":null,"resource_name":"cis_kube_v120_v100_5_1_6"}
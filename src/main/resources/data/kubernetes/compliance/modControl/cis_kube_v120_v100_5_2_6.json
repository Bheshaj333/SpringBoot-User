{"severity":null,"file_name":"/home/bheshaj/steampipe-mod-kubernetes-compliance/cis_kube_v120/cis_kube_v120_v100.sp","documentation":"## Description\n\nDo not generally permit containers to be run as the root user.\n\nContainers may run as any Linux user. Containers which run as the root user, whilst\nconstrained by Container Runtime security features still have a escalated likelihood of\ncontainer breakout.\n\nIdeally, all containers should run as a defined non-UID 0 user.\n\nThere should be at least one PodSecurityPolicy (PSP) defined which does not permit root\nusers in a container.\n\nIf you need to run root containers, this should be defined in a separate PSP and you should\ncarefully check RBAC controls to ensure that only limited service accounts and users are\ngiven permission to access that PSP.\n\n## Remediation\n\nCreate a PSP as described in the Kubernetes documentation, ensuring that the **.spec.runAsUser.rule** is set to either **MustRunAsNonRoot** or **MustRunAs** with the range of UIDs not including 0.\n\n**References**\n\n1. https://kubernetes.io/docs/concepts/policy/pod-security-policy/#enabling-pod-security-policies","query":"kubernetes_compliance.query.pod_security_policy_non_root_container","description":"Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout. There should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.","end_line_number":182,"params":null,"start_line_number":170,"title":"5.2.6 Minimize the admission of root containers","type":null,"mod_name":"kubernetes_compliance","sql":null,"tags":{"plugin":"kubernetes","cis_item_id":"5.2.6","cis_version":"v1.0.0","service":"Kubernetes/PodSecurityPolicy","cis_section_id":"5.2","kubernetes_version":"v1.20","category":"Compliance","cis":"true","cis_type":"automated","cis_level":"2"},"args":{"args_list":null,"refs":null},"auto_generated":false,"path":[["mod.kubernetes_compliance","kubernetes_compliance.benchmark.cis_kube_v120","kubernetes_compliance.benchmark.cis_kube_v120_v100","kubernetes_compliance.benchmark.cis_kube_v120_v100_5","kubernetes_compliance.benchmark.cis_kube_v120_v100_5_2","kubernetes_compliance.control.cis_kube_v120_v100_5_2_1"]],"qualified_name":"kubernetes_compliance.control.cis_kube_v120_v100_5_2_6","source_definition":"control \"cis_kube_v120_v100_5_2_6\" {\n  title         = \"5.2.6 Minimize the admission of root containers\"\n  description   = \"Containers may run as any Linux user. Containers which run as the root user, whilst constrained by Container Runtime security features still have a escalated likelihood of container breakout. There should be at least one PodSecurityPolicy (PSP) defined which does not permit root users in a container.\"\n  query         = query.pod_security_policy_non_root_container\n  documentation = file(\"./cis_kube_v120/docs/cis_kube_v120_v100_5_2_6.md\")\n\n  tags = merge(local.cis_kube_v120_v100_5_2_common_tags, {\n    cis_level   = \"2\"\n    cis_item_id = \"5.2.6\"\n    cis_type    = \"automated\"\n    service     = \"Kubernetes/PodSecurityPolicy\"\n  })\n}","is_anonymous":false,"width":null,"resource_name":"cis_kube_v120_v100_5_2_6"}